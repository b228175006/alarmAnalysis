# 历史告警数据分析需求设计
---
## 1. 概述
本次需求设计是基于广铁现场的历史告警数据进行可视化需求设计，为下一步和客户进行现场电务处帽子系统需求确认提供切实的demo作为确认依据。
在设计上有两大要求：一是要求需求本身符合客户业务场景，能够为客户提供一定的决策或者业务参考，二是要求需求能够支撑设计，具备实现的可能性。
## 2. 告警数据场景分析
告警数据目前在现场的应用场景主要体现在告警的监测及故障的排查上面，而我们希望针对告警数据进行挖掘体现出更多的价值来。基于此，我们将告警数据的需求场景分为基本应用场景和扩展应用场景，基本应用场景体现在通过对告警数据的统计形成监测和对告警数据的分析辅助故障定位，扩展应用场景通过对告警数据的挖掘辅助用户在管理和业务上的决策。
### 2.1 基本应用场景
基本应用场景分为两部分，一是从不同的业务维度对告警数据进行统计，并以可视化手段进行展示，以满足告警的监测需求；二是通过对告警数据的相关性分析找到故障根源以辅助故障的定位及处理。
#### 2.1.1 告警数据统计
#### 2.1.2 告警数据相关性分析
在进行相关性分析之前，首先我们需要明确以下几个概念：  
a. 故障必然产生告警，但告警不一定代表有故障，有可能是系统配置改变、性能异常等以告警形式上报。  
b. 一个故障可能是另一个故障的根源，但一个告警不会产生出其它告警。  
c. 告警相关性分析通过对告警数据的分析，将多条告警合并为能反映故障根本原因的告警，准确定位故障。  
从上述概念中可以看出，告警相关性分析的目标是辅助故障定位，过程是先确定告警数据之间的相关性，然后判断并过滤冗余告警，最后找出代表故障的根源告警。  
基于此过程，首先我们先明确告警的相关性类型，然后选取分析手段方法建立起告警关联规则，最后确定展示方式。  
##### 2.1.2.1 告警相关性类型
根据资料，常见的告警相关性类型如下：  
1) 告警压缩：将发生的多个告警压缩到一个告警中，适用于相同网元，具有相同特征的重复告警，如同一设备在短时间内发送的相同类型的告警。  
2) 告警过滤：如果告警代表的含义并非故障，则将其过滤掉，适用于系统配置改变、性能异常等告警形式。  
3) 告警抑制：在主要告警发生的情况下，抑制次要告警，适用于一条告警（主要告警）出现会产生一条或多条其他告警（次要告警）的主次告警场景。主次告警可分为无资源关系和有资源关系两类。无资源关系的主次告警，指主要告警和次要告警没有资源关联关系，只有业务特征关系。有资源关系的主次告警，指主要告警和次要告警有资源关联关系，如父子网元关系、关联网元关系以及网元内部板卡和端口关系等。  
4) 告警计数：对重复到达的告警记录次数和设定阈值，适用于相同网元具有相同特征的重复告警。和告警压缩不同的是，此处的特征范围有可能比告警压缩时的特征范围更大，此处的告警发生频次更低、时间跨度更长。  
5) 告警泛化：用告警的超类代替该告警，适用于有次要告警但没有主要告警数据，且实际故障发生在主要设备上的场景。  
6) 告警特化：用告警的特定子集代替该告警，适用于有主要告警但没有次要告警数据，且实际故障发生在次要设备上的场景。  
7) 告警时序关系：相关告警依赖于告警发生时间顺序，适用于无资源关系、无业务特征关系、仅在时间先后上有关联的告警链。  
据现场需求反馈，第6、7项相关性类型仅存在于网元级网管系统中，而我们的综合网管系统为网管级网管系统，接入的专业网管为网元级网管系统，所以实际应用场景中没有这两项相关性类型。
##### 2.1.2.2 告警相关性分析方法
1. 采用数据控掘手段确定告警数据中具备哪些类型的相关性。  
针对告警抑制类型，在存在资源相关性的前提下，我们需要将资源数据对应的关系整合到告警数据中去，以便进行资源相关性的类型识别。  
在不存在资源相关性时，我们需要从时间维度上识别主从告警，检杳以下三种情况：  
    第一种情况是在相同时间间隔出现的多条告警关系，我们选择在时间维度上和某告警总是同步出现的所有告警，出现时间差初步制定为不超过3秒，根据挖掘结果迭代更改；类型匹配度达到80％（暂定，根据迭代修改）则成功匹配。  
    第二种情况是在某告警出现前1分钟（暂定，根据迭代修改）的所有告警和该告警的关系，即这些告警总是在某告警前1分钟出现；类型匹配度达到80％（暂定，根据迭代修改）则成功匹配。  
    第三种情况是在某告警出现后1分钟内的所有告警和该告警的关系，即这些告警总是在某告警出现后的1分钟内出现；类型匹配度达到80％（暂定，根据迭代修改）则成功匹配。  
2. 根据实际存在的告警相关性类型建立辅助学习的训练样本集。  
3. 使用训练样本集进行辅助学习，形成相关性分析规则。  
4. 使用相关性分析规则对其它告警数据进行分析，检验是否能够判断出根源告警。如无法达到预期效果，则重新迭代1-3步。  
##### 2.1.2.3 告警相关性分析展示
以树形图形式展示根源告警和衍生告警之间的关系。
### 2.2 扩展应用场景

